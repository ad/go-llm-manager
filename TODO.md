# TODO: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (upvote/downvote) –¥–ª—è –∑–∞–¥–∞—á

## ‚úÖ –°–¢–ê–¢–£–°: –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ò –ò–°–ü–†–ê–í–õ–ï–ù–û

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: –º–∏–≥—Ä–∞—Ü–∏–∏, –º–æ–¥–µ–ª–∏, —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ API: POST `/api/tasks/vote` —Å JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π 
- ‚úÖ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π API: GET `/api/internal/rating-stats` –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π API: GET `/api/internal/rating-analytics` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏  
- ‚úÖ UI: –±–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ (/admin)
- ‚úÖ UI: –∫–Ω–æ–ø–∫–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è üëç/üëé –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- ‚úÖ UI: –¥–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ (/admin)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±–∞–≥–∏: –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤–æ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
- ‚úÖ –¢–µ—Å—Ç—ã: –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ unit-—Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –¢–µ—Å—Ç—ã: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ–≥–æ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –æ–±–Ω–æ–≤–ª–µ–Ω API.md
- ‚úÖ –õ–æ–≥–∏–∫–∞: toggle behavior (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫ —É–±–∏—Ä–∞–µ—Ç –≥–æ–ª–æ—Å)
- ‚úÖ SSE —Å–æ–±—ã—Ç–∏—è: –≤–∫–ª—é—á–∞—é—Ç rating –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –∫–∞—Ä—Ç–æ—á–∫–∏ –º–µ—Ç—Ä–∏–∫, –≥—Ä–∞—Ñ–∏–∫–∏, –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!**

**–ù–µ–¥–∞–≤–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∏—é–ª—å 2025):**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∫–Ω–æ–ø–æ–∫ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–Ω–æ–ø–æ–∫ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å" 
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã SSE —Å–æ–±—ã—Ç–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è rating
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ onclick —Å–æ–±—ã—Ç–∏–π –≤ JavaScript
- ‚úÖ –£–ª—É—á—à–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –ø–æ—Å–ª–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

## –û–±–∑–æ—Ä
–î–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á, –≤–∫–ª—é—á–∞—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Ç–µ—Å—Ç—ã.

## 1. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
- [x] **–§–∞–π–ª**: `migrations/0002_add_task_rating.sql`
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü—É `tasks`:
```sql
-- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –¥–ª—è –≥–æ–ª–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞ —Å–≤–æ—é –∑–∞–¥–∞—á—É
ALTER TABLE tasks ADD COLUMN rating TEXT CHECK (rating IN ('upvote', 'downvote', NULL));
```

### 1.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã
- [x] –û–±–Ω–æ–≤–∏—Ç—å `0001_initial_schema.sql` –¥–ª—è –Ω–æ–≤—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫ (–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü—É tasks)
- [x] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ `rating` –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: `CREATE INDEX idx_tasks_rating ON tasks(rating);`
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î

## 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—è—Ö –¥–∞–Ω–Ω—ã—Ö

### 2.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Task
- [x] **–§–∞–π–ª**: `internal/database/models.go`
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `Task`:
```go
type Task struct {
    // ...—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è...
    UserRating *string `json:"rating,omitempty" db:"rating"` // "upvote", "downvote" –∏–ª–∏ NULL
}
```

### 2.2 –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
- [x] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è API –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:
```go
type VoteRequest struct {
    VoteType string `json:"vote_type" binding:"required"` // "upvote" –∏–ª–∏ "downvote" (–ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ —É–±–∏—Ä–∞–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥)
}

type VoteResponse struct {
    Success    bool    `json:"success"`
    UserRating *string `json:"rating,omitempty"` // —Ç–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–¥–∞—á–∏
}
```

## 3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (—Ñ—É–Ω–∫—Ü–∏–∏)

### 3.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
- [x] **–§–∞–π–ª**: `internal/database/tasks.go`
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `UpdateTaskRating(taskID, userID string, rating *string) error`:
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–¥–∞—á–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (`status = 'completed'`)
  - –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª–µ `rating` (nullable –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞)
- [x] –û–±–Ω–æ–≤–∏—Ç—å `GetTask()` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª–µ–π —Ä–µ–π—Ç–∏–Ω–≥–∞
- [x] –û–±–Ω–æ–≤–∏—Ç—å `GetUserLatestTask()` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª–µ–π —Ä–µ–π—Ç–∏–Ω–≥–∞
- [x] –û–±–Ω–æ–≤–∏—Ç—å `GetAllTasks()` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª–µ–π —Ä–µ–π—Ç–∏–Ω–≥–∞

### 3.2 –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `GetTasksRatingStats() (upvotes, downvotes int, err error)` –¥–ª—è –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `GetUserRatedTasks(userID string) ([]*Task, error)` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ü–µ–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## 4. –ù–æ–≤—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 4.1 –ü—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞
- [x] **–§–∞–π–ª**: `internal/api/handlers/public.go`
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `VoteTask(w http.ResponseWriter, r *http.Request)` (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–∞–∫ VoteTask):
  - –ú–µ—Ç–æ–¥—ã: POST
  - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: JWT (–¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `user_id` –∏ `taskId`)
  - –ú–∞—Ä—à—Ä—É—Ç: `/api/tasks/vote`
  - –í–∞–ª–∏–¥–∞—Ü–∏—è: 
    - –ó–∞–¥–∞—á–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    - –ó–∞–¥–∞—á–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (`status = 'completed'`)
  - –õ–æ–≥–∏–∫–∞: –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–¥–∞—á–∏ (upvote/downvote, –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ —É–±–∏—Ä–∞–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥)
  - –û—Ç–≤–µ—Ç: —Ç–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–¥–∞—á–∏ –∏ —Å—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–∏
- [x] –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç `/api/tasks/vote` –≤ `cmd/server/main.go`

### 4.2 –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
- [x] **–§–∞–π–ª**: `internal/api/handlers/internal.go`
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `GetRatingStats(w http.ResponseWriter, r *http.Request)`:
  - –ú–µ—Ç–æ–¥—ã: GET
  - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: API –∫–ª—é—á
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: user_id (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - –û—Ç–≤–µ—Ç: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ (–æ–±—â–∞—è –∏–ª–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)
- [x] –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç `/api/internal/rating-stats`

## 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤

### 5.1 –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (/admin)
- [x] **–§–∞–π–ª**: `internal/api/handlers/admin.html` (–Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª—Å—è - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ JS)
- [x] –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–¥–∞—á (–ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —É–±–∏—Ä–∞–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥) (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ createVotingButtons())

- [x] **–§–∞–π–ª**: `internal/api/handlers/admin.js`
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞:
```javascript
async function voteTask(taskId, voteType) {
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω
}

function createVotingButtons(task) {
    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
}
```

- [x] **–§–∞–π–ª**: `internal/api/handlers/admin.css`
- [x] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–µ–π—Ç–∏–Ω–≥–∞ (vote-button, vote-active –∏ –¥—Ä.)

### 5.2 –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (/query)
- [x] **–§–∞–π–ª**: `internal/api/handlers/query.html`
- [x] –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å SSE polling –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∫–∞–∑–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏

### 5.3 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `displayAllTasks()` –≤ admin.js –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –∑–∞–¥–∞—á
- ‚ùå –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∑–∞–¥–∞—á –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É (–æ—Ü–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ/–Ω–µ –æ—Ü–µ–Ω–µ–Ω–Ω—ã–µ) - **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

## 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### 6.1 –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤ API.md
- [x] **–§–∞–π–ª**: `API.md`
- [x] –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è `/api/tasks/vote`:
  - JWT –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `user_id` –∏ `taskId`.
  - –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞: `{ "vote_type": "upvote|downvote|"" }`
  - –û—Ç–≤–µ—Ç: `{ "success": true, "rating": "upvote" }`
- [x] –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è `/api/internal/rating-stats`
- [x] –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–¥–∞—á–∏ —Å –ø–æ–ª—è–º–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞

## 7. –¢–µ—Å—Ç—ã

### 7.1 –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [x] **–§–∞–π–ª**: `internal/database/tasks_rating_test.go`
- [x] –¢–µ—Å—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π —Ä–µ–π—Ç–∏–Ω–≥–∞:
```go
func TestUpdateTaskRating(t *testing.T)
func TestUpdateTaskRating_NotOwner(t *testing.T)
func TestUpdateTaskRating_NotCompleted(t *testing.T)
func TestGetTasksRatingStats(t *testing.T)
func TestGetUserRatedTasks(t *testing.T)
```

### 7.2 –¢–µ—Å—Ç—ã –¥–ª—è API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- [x] **–§–∞–π–ª**: `internal/api/handlers/vote_test.go` (—Å–æ–∑–¥–∞–Ω –≤–º–µ—Å—Ç–æ rating_test.go)
- [x] –¢–µ—Å—Ç—ã –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:
```go
func TestVoteTask_Success(t *testing.T)
func TestVoteTask_InvalidJWT(t *testing.T)
func TestVoteTask_NotOwner(t *testing.T)
func TestVoteTask_TaskNotCompleted(t *testing.T)
func TestVoteTask_UpdateRating(t *testing.T)
func TestVoteTask_RemoveRating(t *testing.T)
```

### 7.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚úÖ **–§–∞–π–ª**: `internal/api/handlers/integration_test.go` - **–°–û–ó–î–ê–ù –ò –†–ï–ê–õ–ò–ó–û–í–ê–ù**
- ‚úÖ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ ‚Üí –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ ‚Üí —Ä–µ–π—Ç–∏–Ω–≥ - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞ –∑–∞–¥–∞—á–∏ - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞ (toggle behavior) - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –¢–µ—Å—Ç –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ (pending task, —á—É–∂–∞—è –∑–∞–¥–∞—á–∞) - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

## 8. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 8.1 –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á –ø–æ –≤—Ä–µ–º–µ–Ω–∏ - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ (/admin) - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**  
- ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç GET /api/internal/rating-analytics - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: GetRatingStatsByPeriod, GetRecentRatedTasks - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: –∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ—Ü–µ–Ω–æ–∫ - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ - **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

### 8.2 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùå SSE —Å–æ–±—ã—Ç–∏—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Ä–µ–π—Ç–∏–Ω–≥–∞—Ö - **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π - **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

### 8.3 –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚ùå Rate limiting –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞ (–Ω–µ –±–æ–ª–µ–µ 5 –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ –º–∏–Ω—É—Ç—É) - **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚ùå –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π —Ä–µ–π—Ç–∏–Ω–≥–∞ –¥–ª—è –∞—É–¥–∏—Ç–∞ - **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- ‚ùå –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ–π—Ç–∏–Ω–≥–∞ - **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

## 9. –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É

### –§–∞–∑–∞ 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å):
1. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (1.1, 1.2)
2. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (2.1, 2.2)
3. –§—É–Ω–∫—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (3.1, 3.2)
4. –û—Å–Ω–æ–≤–Ω–æ–π API —ç–Ω–¥–ø–æ–∏–Ω—Ç (4.1)

### –§–∞–∑–∞ 2 (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å):
5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ (5.1)
6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (5.2)
7. –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (7.1, 7.2)

### –§–∞–∑–∞ 3 (–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è):
8. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (6.1)
9. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (7.3)
10. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (8.1-8.3)

## 10. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏

- [x] **Checkpoint 1**: –ú–∏–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–¥–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- [x] **Checkpoint 2**: API —ç–Ω–¥–ø–æ–∏–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –≥–æ–ª–æ—Å–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ API
- [x] **Checkpoint 3**: UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å
- [x] **Checkpoint 4**: –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [x] **Checkpoint 5**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞, –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

## –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É):
1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –º–∏–≥—Ä–∞—Ü–∏—è 0002_add_task_rating.sql, –º–æ–¥–µ–ª–∏ —Å –ø–æ–ª–µ–º UserRating
2. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**: POST /api/tasks/vote, GET /api/internal/rating-stats, GET /api/internal/rating-analytics
3. **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: –∫–Ω–æ–ø–∫–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
4. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: –¥–∞—à–±–æ—Ä–¥ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –º–µ—Ç—Ä–∏–∫, –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Å–ø–∏—Å–∫–æ–º –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ—Ü–µ–Ω–æ–∫
5. **–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: —Å–µ–∫—Ü–∏—è —Å –æ–±—â–µ–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
5. **JavaScript –ª–æ–≥–∏–∫–∞**: —Ñ—É–Ω–∫—Ü–∏–∏ voteTask, createVotingButtons, loadRatingAnalytics, loadBasicRatingStats, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
6. **CSS —Å—Ç–∏–ª–∏**: vote-button, vote-active, rating-analytics-container, basic-rating-stats-container –∫–ª–∞—Å—Å—ã
7. **Unit —Ç–µ—Å—Ç—ã**: tasks_rating_test.go, vote_test.go
8. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**: integration_test.go —Å –ø–æ–ª–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
9. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –æ–±–Ω–æ–≤–ª–µ–Ω API.md
10. **SSE –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: rating –≤–∫–ª—é—á–µ–Ω –≤ —Å–æ–±—ã—Ç–∏—è task_completed
11. **–§—É–Ω–∫—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**: GetRatingStatsByPeriod, GetRecentRatedTasks –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è):
1. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á** –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É –≤ UI
2. **Rate limiting** –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
3. **–ê—É–¥–∏—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–µ–π—Å—Ç–≤–∏–π —Ä–µ–π—Ç–∏–Ω–≥–∞

**–í—ã–≤–æ–¥: –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.**

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –†–µ–π—Ç–∏–Ω–≥ —Ä–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–¥–∞—á —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `completed`
- –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –∑–∞–¥–∞—á–∏ –º–æ–∂–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –µ—ë –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è (–ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ —É–±–∏—Ä–∞–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥)
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞
- –°–∏—Å—Ç–µ–º–∞ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
